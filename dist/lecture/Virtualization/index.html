<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">
	<title>Платформы виртуализации</title>
	<meta name="description" content="Платформы виртуализации">
	<meta name="keywords" content="Гипервизор, Hyper-V">
	<meta name="author" content="Maks Hladki">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="../../css/bundle.min.css">
	<!--[if lt IE 9]>
		<script src="../../js/html5shiv.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<section>
					<h1>Платформы виртуализации</h1>
					<h3>Облачные технологии</h3>
					<p>
						<small>Гладкий Максим Валерьевич / <a href="https://github.com/MaksHladki">github:MaksHladki</a></small>
					</p>
				</section>
				<section>
					<h2>Содержание лекции</h2>
					<nav id="presentable-toc" class="table-content"></nav>
				</section>
			</section>
			<section>
				<h1>Виртуализация</h1>
			</section>
			<section>
				<h2>Виртуализация</h2>
				<blockquote>
					Виртуализация — предоставление набора вычислительных ресурсов или их логического объединения, абстрагированное от аппаратной
					реализации, и обеспечивающее при этом логическую изоляцию друг от друга вычислительных процессов, выполняемых на одном
					физическом ресурсе
				</blockquote>
				<p>ИЛИ</p>
				<blockquote>
					Технология виртуализации позволяет создать несколько виртуальных машин на одном физическом компьютере и совместно использовать
					его ресурсы в нескольких средах
				</blockquote>
			</section>
			<section>
				<h2>Преимущества виртуализации</h2>
				<ul>
					<li>Запуск нескольких ВМ</li>
					<li>Выполнение нескольких приложений в изолированной среде</li>
					<li>Увеличение эффективности использования вычислительных ресурсов</li>
					<li>Сокращение затрат на приобретение и поддержку оборудования</li>
					<li>Облегчение процесса администрирования системы</li>
					<li>Сокращение штата IT-сотрудников</li>
					<li>Клонирование и резервирование</li>
				</ul>
			</section>
			<section>
				<h2>Недостатки виртуализации</h2>
				<ul>
					<li>Невозможность эмуляции всех устройств</li>
					<li>Дополнительных аппаратных ресурсов</li>
					<li>Платные платформы виртуализации</li>
				</ul>
			</section>
			<section>
				<h2>Области применения виртуализации</h2>
				<ul>
					<li><span class="highlight-blue">Виртуальные машины</span> - полностью изолированный программный контейнер, который работает
						с собственной ОС и приложениями, подобно физическому компьютеру</li>
					<li><span class="highlight-blue">Виртуализация ресурсов</span> - разделение одного физического узла на несколько частей,
						каждая из которых видна для владельца в качестве отдельного сервера
					</li>
					<li><span class="highlight-blue">Виртуализация приложений</span> - процесс использования приложения, преобразованного из
						требующего установки в операционную систему в не требующее (требуется только запустить). ПО виртуализатора определяет
						при установке виртуализуемого приложения, какие требуются компоненты ОС, и эмулирует их </li>
				</ul>
			</section>
			<section>
				<h2>Виды виртуализации</h2>
				<ul>
					<li>Полная виртуализация оборудования (эмуляция)</li>
					<li>Операционные системы</li>
					<li>Программное обеспечение - работа отдельных приложений в среде, отделённой от основной ОС</li>
					<li>Память - объединением оперативной памяти из различных ресурсов в единый массив, либо изоляция адресного пространства
						приложения от всего адресного пространства</li>
					<li>Хранилище данных - виртуализация хранения данных, представление набора физических носителей в виде единого физического
						носителя
					</li>
					<li>База данных - представление данных в абстрактном виде, независимо от нижележащих систем управления и хранения данных,
						а также их структуры</li>
					<li>Сеть - процесс объединения аппаратных и программных сетевых ресурсов в единую виртуальную сеть</li>
				</ul>
			</section>
			<section>
				<h2>Классы виртуализации</h2>
				<ul>
					<li>Аппаратная виртуализация</li>
					<li>Программная виртуализация</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Аппаратная виртуализация</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Аппаратная виртуализация — виртуализация с поддержкой специальной процессорной архитектуры. Возможно использование изолированных
						гостевых систем, управляемых гипервизором напрямую. Гостевая система не зависит от архитектуры хостовой платформы и
						реализации платформы виртуализации. В режиме поддержки виртуализации запускается специальное программное обеспечение,
						являющееся «легковесной» прослойкой между гостевыми операционными системами и оборудованием – монитор виртуальных машин
						(Virtual Machine Monitor)
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/аппаратная_виртуализация.png" alt="" height="550">
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Упрощение разработки программных платформ виртуализации за счет предоставления аппаратных интерфейсов управления и
							поддержки виртуальных гостевых систем</li>
						<li>Управление виртуальными гостевыми системами осуществляет напрямую небольшой промежуточный слой программного обеспечения,
							гипервизор, что дает увеличение быстродействия</li>
						<li>
							Улучшается защищенность - возможность переключения между несколькими запущенными независимыми платформами виртуализации на
							аппаратном уровне. Каждая из ВМ работает независимо в своем пространстве аппаратных ресурсов, полностью изолированно
							друг от друга
						</li>
					</ul>
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Гостевая система становится непривязанной к архитектуре хостовой платформы и к реализации платформы виртуализации.</li>
						<li>Технология аппаратной виртуализации делает возможным запуск 64-битных гостевых систем на 32-битных хостовых системах</li>
						<li>
							Интерфейс монитора виртуальных машин полностью (либо частично) повторяет интерфейс виртуализуемой системы, поэтому, ПО не
							может определить факт присутствия гипервизора
						</li>
					</ul>
				</section>
				<section>
					<h3>Пример решений</h3>
					<ul>
						<li>Intel Virtualization Technology</li>
						<li>AMD Virtualization</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Программная виртуализация</h2>
					<ul>
						<li>Программная полная виртуализация</li>
						<li>Программная паравиртуализация</li>
						<li>Виртуализации уровня операционной системы</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Программная полная виртуализация</h2>
					<blockquote>
						Представляет собой полную эмуляцию оборудования на уровне программного обеспечения путем модификации команд гипервизором
						(динамической трансляции) - проблемные команды гостевой ОС перехватываются гипервизором. После того как эти команды
						заменяются на безопасные, происходит возврат управления гостевой системе
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/полная_виртуализация.png" alt="">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Возможность реализовать виртуализацию проприетарных операционных систем (Windows, MacOS), где нет возможности модифицировать
							ядро системы</li>
						<li>Полная трансляция и модификация бинарного кода — весьма ресурсоемкая операция
						</li>
						<li>Невысокая производительность</li>
					</ul>
				</section>
				<section>
					<h3>Основные компоненты</h3>
					<ul>
						<li>Приложение виртуальной машины</li>
						<li>Драйвер виртуальных машин</li>
						<li>Монитор виртуальной машины</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Программная паравиртуализация</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Паравиртуализация — техника виртуализации, при которой гостевые операционные системы подготавливаются для исполнения в виртуализированной
						среде, для чего их ядро незначительно модифицируется. Операционная система взаимодействует с программой гипервизора,
						который предоставляет ей гостевой API, вместо использования напрямую таких ресурсов, как таблица страниц памяти
					</blockquote>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Более высокая производительность, чем метод динамической трансляции</li>
						<li>Требуется модифицированное ядро (для тех команд, что не поддаются виртуализизации)</li>
						<li>Для модификации ядра нужны его исходные коды, либо гипервизор и гостевая ОС должны быть разработаны одним производителем</li>
					</ul>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/паравиртуализация.png" alt="">
				</section>
			</section>
			<section>
				<section>
					<h2>Виртуализации уровня операционной системы</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Виртуализация на уровне операционной системы — метод виртуализации, при котором ядро операционной системы поддерживает несколько
						изолированных экземпляров пространства пользователя, вместо одного. Эти экземпляры (контейнеры) с точки зрения пользователя
						полностью идентичны реальному серверу. А ядро обеспечивает полную изолированность контейнеров, поэтому программы из
						разных контейнеров не могут воздействовать друг на друга
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/виртуализация_на_уровне_ос.png" alt="">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Контейнеры выполняются на одном уровне с физическими серверами. Отсутствие виртуализованного оборудования и использование
							реального оборудования и драйверов позволяют получить непревзойденную производительность</li>
						<li>Каждый контейнер может масштабироваться до ресурсов целого физического сервера</li>
						<li>Позволяет добиться высочайшей плотности использование виртуализации среди доступных решений. Возможно создание и запуск
							сотен контейнеров на одном обычном физическом сервере</li>
						<li>Контейнеры используют единую ОС, что делает их поддержку и обновление очень простым. Приложения могут быть также развернуты
							в отдельном окружении</li>
					</ul>
				</section>
			</section>
			<section>
				<h1>Гипервизор</h1>
			</section>
			<section>
				<section>
					<h2>Гипервизор</h2>
					<blockquote>
						Гипервизор – это платформа виртуализации, позволяющая запускать на одном физическом компьютере несколько операционных систем.
						Именно гипервизор предоставляет изолированное окружение для каждой виртуальной машины, и именно он предоставляет гостевым
						ОС доступ к аппаратному обеспечению компьютера
					</blockquote>
				</section>
			</section>
			<section>
				<section>
					<h2>Типы гипервизора</h2>
					<ul>
						<li>Гипервизор 1 типа</li>
						<li>Гипервизор 2 типа</li>
						<li>Гипервизор гибридный</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Гипервизор 1 типа</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Гипервизор 1 типа запускается непосредственно на физическом «железе» и управляет им самостоятельно. Гостевые ОС, запущенные
						внутри виртуальных машин, располагаются уровнем выше
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/hypervisor_1.png" alt="" height="550">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Работает непосредственно с оборудованием (позволяет достичь большей производительности, надежности и безопасности)</li>
						<li>Имеет свои встроенные драйверы устройств, модели драйверов и планировщик</li>
						<li>Не зависит от базовой ОС</li>
						<li>Автономный, работает непосредственно в окружении усеченного ядра</li>
					</ul>
				</section>
				<section>
					<h3>Пример</h3>
					<ul>
						<li>VMware ESX</li>
						<li>Citrix</li>
						<li>XenServer</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Гипервизор 2 типа</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Гипервизор второго типа (хостовый, монитор виртуальных машин) — специальный дополнительный программный слой, расположенный
						поверх основной хостовой ОС, который в основном выполняет функции управления гостевыми ОС, а эмуляцию и управление
						аппаратурой берет на себя хостовая ОС
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/hypervisor_2.png" alt="" height="550">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Виртуальные машины запускаются в пользовательском пространстве хостовой ОС</li>
						<li>Худший уровень производительности</li>
					</ul>
				</section>
				<section>
					<h3>Пример</h3>
					<ul>
						<li>VMware Server</li>
						<li>VirtualBox</li>
						<li>VMware Workstation</li>
						<li>QEMU</li>
						<li>Parallels</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Гипервизор гибридный</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Объединенный вариант первых двух, в котором функции управления аппаратными средствами выполняются тонким гипервизором и специальной
						депривилегированной сервисной ОС, работающей под управлением тонкого гипервизора. Обычно гипервизор управляет напрямую
						процессором и памятью компьютера, а через сервисную ОС гостевые ОС работают с остальными аппаратными компонентами
					</blockquote>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Состоит из двух частей: из тонкого гипервизора, контролирующего процессор и память, а также работающей под его управлением
							специальной сервисной ОС в кольце пониженного уровня. Через сервисную ОС гостевые ОС получают доступ к физическому
							оборудованию
						</li>
						<li>Эффективен при высокой вычислительной нагрузке, когда используется только “тонкий” гипервизор, который в случае Microsoft
							занимает всего порядка 100 Кб оперативной памяти</li>
					</ul>
				</section>
				<section>
					<h3>Пример</h3>
					<ul>
						<li>Sun Logical Domains</li>
						<li>Xen</li>
						<li>Citrix XenServer</li>
						<li>Microsoft Hyper-V</li>
					</ul>
				</section>
			</section>
			<section>
				<h2>Архитектура гипервизоров</h2>
			</section>
			<section>
				<section>
					<h2>Монолитный гипервизор</h2>
					<blockquote>
						Гипервизоры монолитной архитектуры включают драйверы аппаратных устройств в свой код. Гостевые ОС работают на виртуальных
						машинах поверх гипервизора. Когда гостевой системе нужен доступ к оборудованию, она должна пройти через гипервизор
						и его модель драйверов. Обычно одна из гостевых ОС играет роль ад­министратора или консоли, в которой администратор
						запускает компоненты для предоставления ресурсов, управления и мониторинга всех гостевых ОС, работающих на компьютере
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/hypervisor_monolite.png" alt="" height="550">
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Более высокая производительность из-за нахождения драйверов в пространстве гипервизора</li>
						<li>Более высокая надежность, так как сбои в работе управляющей ОС/Службы (Service Console) не приведет к сбою всех запущенных
							виртуальных машин</li>
					</ul>
				</section>
				<section>
					<h3>Недостатки</h3>
					<ul>
						<li>Поддерживается только то оборудование, драйверы на которое имеются в гипервизоре</li>
						<li>Потенциально более низкая безопасность – из-за включения в гипервизор стороннего кода в виде драйверов устройств. Поскольку
							код драйверов выполняется в пространстве гипервизора, существует теоретическая возможность воспользоваться уязвимостью
							в коде и получить контроль как над хостовой ОС, так и над всеми гостевыми</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Микроядерная архитектура</h2>
					<blockquote>
						При микроядерной архитектуре драйверы устройств работают внутри хостовой ОС. Хостовая ОС в этом случае запускается в таком
						же виртуальном окружении, как и все ВМ, и именуется «родительской партицией». Все остальные окружения, соответственно
						– «дочерние»
					</blockquote>
					<blockquote>
						Единственная разница между родительской и дочерними партициями состоит в том, что только родительская партиция имеет непосредственный
						доступ к оборудованию сервера. Выделением памяти же и планировкой процессорного времени занимается сам гипервизор
					</blockquote>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/hypervisor_microkernel.png" alt="" height="550">
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Не требуются драйвера, «заточенные» под гипервизор. Гипервизор микроядерной архитектуры совместим с любым оборудованием,
							имеющим драйверы для ОС родительской партиции</li>
						<li>Поскольку драйверы выполняются внутри родительской партиции – у гипервизора остается больше времени на более важные
							задачи – управление памятью и работу планировщика</li>
						<li>Более высокая безопасность. Гипервизор не содержит постороннего кода, соответственно и возможностей для атаки на него
							становится меньше</li>
					</ul>
				</section>
				<section>
					<h3>Недостатки</h3>
					<ul>
						<li>Про­игрывает монолитной модели в производительности</li>
					</ul>
				</section>
			</section>
			<section>
				<h3>Распространенные платформы виртуализации</h3>
				<ul>
					<li>VMWARE (vSphere, One Cloud)</li>
					<li>CITRIX (Xen)</li>
					<li>Oracle VM (Virtual box)</li>
					<li>Microsoft (Hyper-V)</li>
					<li>Parallels (Parallels, OpenVZ)</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Сравнение платформ виртуализации</h2>
				</section>
				<section>
					<h3>Рынок гипервизоров</h3>
					<ul>
						<li>VMWare - 62%</li>
						<li>Microsoft - 27%</li>
						<li>Citrix - 8%</li>
						<li>Другие производители - 3%</li>
					</ul>
				</section>
				<section>
					<h3>Масштабируемость</h3>
					<table>
						<thead>
							<tr>
								<th>Ресурсы</th>
								<th>vSphere</th>
								<th>XenServer</th>
								<th>Hyper-V</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Логические ЦП</td>
								<td>320</td>
								<td>160</td>
								<td>320</td>
							</tr>
							<tr>
								<td>Виртуальные ЦП на хост</td>
								<td>4096</td>
								<td>4000</td>
								<td>2048</td>
							</tr>
							<tr>
								<td>Виртуальные ЦП на ВМ</td>
								<td>64</td>
								<td>16</td>
								<td>64</td>
							</tr>
							<tr>
								<td>Физическая ОЗУ</td>
								<td>4ТБ</td>
								<td>1ТБ</td>
								<td>4ТБ</td>
							</tr>
							<tr>
								<td>ОЗУ на ВМ</td>
								<td>1ТБ</td>
								<td>128ГБ</td>
								<td>1ТБ</td>
							</tr>
							<tr>
								<td>Максимум ВМ</td>
								<td>15000</td>
								<td>1000</td>
								<td>8000</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Производительность</h3>
					<table>
						<thead>
							<tr>
								<th>Возможности</th>
								<th>vSphere</th>
								<th>XenServer</th>
								<th>Hyper-V</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Виртуальный Fibre Channel</td>
								<td>Да</td>
								<td>Да</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Количество адаптеров FC</td>
								<td>256</td>
								<td>150</td>
								<td>4</td>
							</tr>
							<tr>
								<td>Максимальный размер диска</td>
								<td>64 ТБ</td>
								<td>2 ТБ</td>
								<td>64 ТБ</td>
							</tr>
							<tr>
								<td>Разгрузка передачи данных</td>
								<td>Да</td>
								<td>Нет</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Динамическая память</td>
								<td>Да</td>
								<td>Да</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Качество обслуживания</td>
								<td>Да</td>
								<td>Нет</td>
								<td>Да</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Механизмы отказоустойчивости</h3>
					<table>
						<thead>
							<tr>
								<th>Возможности</th>
								<th>vSphere</th>
								<th>XenServer</th>
								<th>Hyper-V</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Встроенный бекап</td>
								<td>Да</td>
								<td>Да</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Репликация ВМ</td>
								<td>Да</td>
								<td>Нет</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Мониторинг гостевых приложений</td>
								<td>Да</td>
								<td>Нет</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Обновление кластерных систем</td>
								<td>Да</td>
								<td>Да</td>
								<td>Да</td>
							</tr>
							<tr>
								<td>Шифрование дисков</td>
								<td>Да</td>
								<td>Нет</td>
								<td>Да</td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>
			<section>
				<h1>Hyper-V</h1>
			</section>
			<section>
				<h2>История</h2>
				<ul>
					<li>2003 - Microsoft acquires Connectix</li>
					<li>2004 - Microsoft Virtual Server 2005</li>
					<li>2005 - Microsoft Virtual Server 2005 R2</li>
					<li>2008 - Microsoft Hyper-V Server 2008</li>
					<li>2009 - Microsoft Hyper-V server 2008 R2</li>
					<li>2011 - Microsoft Hyper-V server 2008 R2 SP1</li>
					<li>2012 - Microsoft Hyper-V server 2012</li>
					<li>2013 - Microsoft Hyper-V server 2012 R2</li>
					<li>2016 - Microsoft Hyper-V server 2016</li>
				</ul>
			</section>
			<section>
				<h2>Два способа развертывания</h2>
				<ul>
					<li>Как отдельная роль внутри ОС Windows</li>
					<li>Как самостоятельная ОС Windows Hyper-V Server</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Архитектура Hyper-V</h2>
				</section>
				<section>
					<h3>Общий вид</h3>
					<img src="img/Viridian_Architecture.svg" alt="" height="550">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Гипервизор работает на следующем уровне после аппаратного обеспечения</li>
						<li>Уровнем выше гипервизора работают родительская и дочерние партиции</li>
						<li>В родительской партиции запускается хостовая ОС (Windows Server 2016) и стек виртуализации. Именно из родительской
							партиции происходит управление внешними устройствами, а так же дочерними партициями</li>
						<li>Дочерние партиции создаются из родительской партиции и предназначены для запуска гостевых ОС
						</li>
						<li>Все партиции связаны с гипервизором через интерфейс гипервызовов, предоставляющий операционным системам специальный
							API
						</li>
					</ul>
				</section>
				<section>
					<h3>Понятие партиции</h3>
					<blockquote>
						Hyper-V поддерживает разграничение согласно понятию раздел (партиция). Раздел — логическая единица разграничения, поддерживаемая
						гипервизором, в котором работают операционные системы
					</blockquote>
					<ul>
						<li>Hyper-V поддерживает разграничение согласно понятию партиция</li>
						<li>Каждый экземпляр гипервизора должен иметь одну родительскую партицию</li>
					</ul>
				</section>
				<section>
					<h3>Алгоритм работы виртуализации</h3>
					<ol>
						<li>Стек виртуализации запускается на родительском разделе и обладает прямым доступом к аппаратным устройствам</li>
						<li>Родительский раздел порождает дочерние разделы, на которых и располагаются гостевые ОС, при помощи API гипервизова</li>
						<li>Дочерний раздел также может породить собственные дочерние разделы</li>
					</ol>
				</section>
			</section>
			<section>
				<section>
					<h2>Стек виртуализации</h2>
					<blockquote>
						Cтек виртуализации - ряд компонент, располагающихся в родительском разделе и имеющих прямой доступ к аппаратному обеспечению
						хостового компьютера
					</blockquote>
					<ul>
						<li>Служба управления виртуальными машинами (VMMS)</li>
						<li>Рабочие процессы виртуальных машин (VMWP)</li>
						<li>Виртуальные устройства</li>
						<li>Драйвер виртуальной инфраструктуры (VID)</li>
						<li>Библиотека интерфейсов гипервизора</li>
					</ul>
				</section>
				<section>
					<h3>Состояния ВМ для службы VMMS</h3>
					<ul>
						<li>Starting</li>
						<li>Active</li>
						<li>Not Active</li>
						<li>Taking Snapshot</li>
						<li>Applying Snapshot</li>
						<li>Deleting Snapshot</li>
						<li>Merging Disk</li>
					</ul>
				</section>
				<section>
					<h3>Рабочий процесс виртуальной машины (VMWP)</h3>
					<blockquote>
						Для управления виртуальной машиной из родительской партиции запускается особый процесс на уровне пользователя – рабочий процесс
						виртуальной машины
					</blockquote>
					<blockquote>
						Для каждой запущенной виртуальной машины служба VMMS запускает отдельный рабочий процесс. Это позволяет изолировать виртуальные
						машины друг от друга. Для повышения безопасности, рабочие процессы запускаются под встроенным пользовательским аккаунтом
						Network Service
					</blockquote>
				</section>
				<section>
					<h3>Возможности</h3>
					<ul>
						<li>Создание, конфигурация и запуск виртуальной машины</li>
						<li>Приостановление и продолжение работы (Pause/Resume)</li>
						<li>Сохранение и восстановление состояния (Save/Restore State)</li>
						<li>Создание моментальных снимков (снапшотов)</li>
						<li>Эмуляция виртуальных материнских плат (VMB), которая используется для предоставления памяти гостевой ОС, управления
							прерываниями и виртуальными устройствами</li>
					</ul>
				</section>
				<section>
					<h3>Виртуальные устройства</h3>
					<blockquote>
						Виртуальные устройства (VDevs) – это программные модули, реализующие конфигурацию и управление устройствами для виртуальных
						машин. VMB включает в себя базовый набор виртуальных устройств, включающий в себя шину PCI и системные устройства
					</blockquote>
				</section>
				<section>
					<h3>Типы устройств</h3>
					<ul>
						<li><span class="highlight-blue">Эмулируемые устройства</span> – эмулируют определенные аппаратные устройства (BIOS, DMA,
							APIC, шины ISA и PCI, контроллеры прерываний т.д.). Именно поэтому для загрузки гостевой ОС может использоваться только
							виртуальный IDE-контроллер, а не SCSI, который является синтетическим устройством</li>
						<li>
							<span class="highlight-blue">Синтетические устройства</span> – не эмулируют реально существующее аппаратное обеспечение
							(синтетический видеоадаптер, устройства взаимодействия с человеком (HID), SCSI-контроллер, синтетический контроллер
							памяти и т.д.). Синтетические устройства могут использоваться только при условии установки компонент интеграции в
							гостевой ОС. Обращаются к аппаратным посредством провайдеров служб виртуализации (VMBus), работающих в родительской
							партиции, что намного быстрее, чем эмуляция физических устройств
						</li>
					</ul>
				</section>
				<section>
					<h3>Драйвер виртуальной инфраструктуры (VID)</h3>
					<blockquote>
						Драйвер виртуальной инфраструктуры (vid.sys) работает на уровне ядра и осуществляет управление партициями, виртуальными процессорами
						и памятью. Так же этот драйвер является промежуточным звеном между гипервизором и компонентами стека виртуализации
						уровня пользователя
					</blockquote>
				</section>
				<section>
					<h3>Библиотека интерфейса гипервизора</h3>
					<blockquote>
						Библиотека интерфейса гипервизора (WinHv.sys) – это DLL уровня ядра, которая загружается как в хостовой, так и в гостевых
						ОС, при условии установки компонент интеграции. Эта библиотека предоставляет интерфейс гипервызовов, использующийся
						для взаимодействия ОС и гипервизора
					</blockquote>
				</section>
				<section>
					<h3>
						Провайдеры служб виртуализации (VSP)
					</h3>
					<blockquote>
						Провайдеры служб виртуализации работают в родительской партиции и предоставляют гостевым ОС доступ к аппаратным устройствам
						через клиент служб виртуализации (VSC). Связь между VSP и VSC осуществляется через виртуальную шину VMBus
					</blockquote>
				</section>
				<section>
					<h3>Шина виртуальных машин (VMBus)</h3>
					<blockquote>
						Предоставление высокоскоростного доступа между родительской и дочерними партициями
					</blockquote>
					<blockquote>
						Взаимодействие происходит по клиент-серверной модели. В родительской партиции запущены провайдеры служб виртуализации (VSP),
						а в дочерних партициях – клиентская часть – VSC. VSC перенаправляет запросы гостевой ОС через VMBus к VSP в родительской
						партиции, а VSP переадресовывает запрос драйверу устройства
					</blockquote>
					<blockquote>
						Если гостевая ОС не поддерживает работу интеграционных компонент – приходится эмулировать устройство. Гипервизору приходится
						перехватывать вызовы гостевых ОС и перенаправлять их к эмулируемым устройствам (снижение производительности)
					</blockquote>
				</section>
			</section>
			<section>
				<section>
					<h2>Разделы</h2>
				</section>
				<section>
					<h3>Родительский раздел</h3>
					<ul>
						<li>Родительский раздел создается системой в первую очередь, как только гипервизор начинает работу</li>
						<li>Родительский раздел используется для создания и управления дочерними разделами системы и включает WMI провайдера, предоставляющего
							интерфейс для удаленного администрирования</li>
						<li>Родительский раздел управляет и распределяет аппаратные ресурсы, за исключением процесса физического распределения
							памяти, который осуществляется гипервизором</li>
						<li>Аппаратные ресурсы родительского раздела являются общими для всех дочерних разделов</li>
						<li>Родительский раздел управляет питанием, "plug and play"-операциями и ведет журналы аппаратных сбоев</li>
					</ul>
				</section>
				<section>
					<h3>Схема</h3>
					<img src="img/HV_родительский_раздел.png" alt="" height="550">
				</section>
				<section>
					<h3>Дочерний раздел (child partition)</h3>
					<blockquote>
						В рамках дочерних разделов функционируют гостевые операционные системы. Гипервизор первого типа поддерживает три основных
						типа дочерних разделов:
					</blockquote>
					<ul>
						<li>С операционной системой семейства Windows и установленными компонентами интеграции</li>
						<li>С операционной системой, отличной от семейства Windows и установленными компонентами интеграции</li>
						<li>С операционной системой, не поддерживающей компоненты интеграции</li>
					</ul>
				</section>
			</section>
			<section>
				<h2>Архитектурные особенности</h2>
				<ul>
					<li>Виртуализированные разделы не имеют доступа к физическому процессору, не могут управлять прерываниями</li>
					<li>Дочерние разделы не имеют непосредственного доступа к аппаратным ресурсам, но получают виртуальное представление ресурсов
						(виртуальные устройства) </li>
					<li>Любая попытка обращения к виртуальным устройствам перенаправляется через VMBus к устройствам родительского раздела,
						которые и обработают данный запрос</li>
					<li>Гипервизор может определять подмножество процессоров для каждого раздела</li>
					<li>Hyper-V может аппаратно ускорять трансляцию адресов между различными гостевыми виртуальными адресными пространствами
						при помощи I/O Memory Management Unit
					</li>
					<li>Виртуальные устройства поддерживают технологию Server Virtualization для накопителей, сетевых и графических подсистем
					</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Особенности Hyper-V</h2>
				</section>
				<section>
					<h3>Хранилище данных</h3>
					<ul>
						<li>Поддержка Virtual Fiber Channel (доступ к Fiber Channel SAN из ВМ)</li>
						<li>Размер Virtual Hard Disk до 64 ТВ</li>
						<li>Offloaded Data Transfer (ODX) - повышает быстродействие используя SAN</li>
					</ul>
				</section>
				<section>
					<h3>Улучшенное управление ресурсами</h3>
					<ul>
						<li>Улучшение Dynamic Memory (более высокий уровень консолидации ВМ)</li>
						<li>Resource Metering (лог истории использования ВМ)</li>
						<li>Quality of Service (QoS) (позволяет обеспечить SLA по производительности ВМ)</li>
						<li>Data Center Bridging (DCB) - объединяет сетевой трафик для повышения QoS</li>
					</ul>
				</section>
				<section>
					<h3>Повышение уровня безопасности и изоляции</h3>
					<ul>
						<li>Private Virtual LAN</li>
						<li>Защита от ARP Spoofing</li>
						<li>DHCP Guard Protection</li>
						<li>Virtual Port ACLs</li>
						<li>Trunk Mode to Virtual Machine</li>
						<li>Monitoring and Port Mirroroing</li>
						<li>Windows PowerShell / WMI Managment</li>
						<li>IPSec</li>
						<li>SR-IOV</li>
						<li>Dynamic Virtual Machine Queue</li>
						<li>Extensible Switch</li>
					</ul>
				</section>
				<section>
					<h3>Физическая безопасность</h3>
					<p>Bitloker encryption</p>
					<ul>
						<li>Шифрование локальных жестких дисков</li>
						<li>Шифрование кластерных дисков</li>
						<li>Шифрование Cluster Shared Volumes</li>
						<li>Изменение Volume level encryption</li>
					</ul>
				</section>
			</section>
			<section>
				<h2>Типы виртуальных машин</h2>
				<ul>
					<li>BIOS based architecture - Generation 1</li>
					<li>UEFI based architecture - Generation 2</li>
				</ul>
			</section>
			<section>
				<h2>Уровни миграции ВМ</h2>
				<ul>
					<li>Live Migration - бысрая миграция ВМ без ограничений</li>
					<li>Live Storage Migration - миграция дисков</li>
					<li>Shared-Nothing Live Migration - перенос ВМ между узлами и кластерами</li>
				</ul>
			</section>
			<section>
				<h2>Виртуальная сеть</h2>
				<ul>
					<li><span class="highlight-blue">Внешняя сеть</span> - позволяет ВМ взаимодействовать с внешними сетями и хостом. При ее
						создании необходимо выбрать один из физических сетевых адаптеров, через который данная виртуальная сеть будет соединяться
						с внешними сетями</li>
					<li><span class="highlight-blue">Внутренняя сеть</span> - предназначена для подключения ВМ и хоста и не предусматривает
						соединения с внешними сетями. При ее создании создается виртуальный сетевой адаптер для хоста, который подключен к
						виртуальному коммутатору внутренней сети и должен быть сконфигурирован в соответствии с настройками виртуальной сети</li>
					<li><span class="highlight-blue">Частная сеть</span> - подобна внутренней сети, НО виртуальный коммутатор может быть подключен
						только к ВМ и изолирован от хоста</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Пример создания ВМ 1</h2>
				</section>
				<section>
					<h3>Установка Hyper-V</h3>
					<img src="img/HV_1.png" alt="" height="550">
				</section>
				<section>
					<h3>Hyper-V Manager</h3>
					<img src="img/HV_2.png" alt="" height="550">
				</section>
				<section>
					<h3>Hyper-V Manager</h3>
					<img src="img/HV_3.png" alt="" height="550">
				</section>
				<section>
					<h3>Создание новой ВМ</h3>
					<img src="img/HV_4.png" alt="" height="550">
				</section>
				<section>
					<h3>Название и путь</h3>
					<img src="img/HV_5.png" alt="" height="550">
				</section>
				<section>
					<h3>Выбор типа</h3>
					<img src="img/HV_6.png" alt="" height="550">
				</section>
				<section>
					<h3>Размер ОП</h3>
					<img src="img/HV_7.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройка сети</h3>
					<img src="img/HV_8.png" alt="" height="550">
				</section>
				<section>
					<h3>Virtual Hard Disk</h3>
					<img src="img/HV_9.png" alt="" height="550">
				</section>
				<section>
					<h3>Дополнительные опции</h3>
					<img src="img/HV_10.png" alt="" height="550">
				</section>
				<section>
					<h3>Создание сетевого подключения</h3>
					<img src="img/HV_11.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройка параметров подключения</h3>
					<img src="img/HV_12.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: hardware</h3>
					<img src="img/HV_13.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: firmware</h3>
					<img src="img/HV_14.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: security</h3>
					<img src="img/HV_15.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: memory</h3>
					<img src="img/HV_16.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: processor</h3>
					<img src="img/HV_17.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: SCSI</h3>
					<img src="img/HV_18.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: network</h3>
					<img src="img/HV_19.png" alt="" height="550">
				</section>
				<section>
					<h3>Запуск ВМ</h3>
					<img src="img/HV_20.png" alt="" height="550">
				</section>
				<section>
					<h3>Установка ОС</h3>
					<img src="img/HV_21.png" alt="" height="550">
				</section>
				<section>
					<h3>Результат установки</h3>
					<img src="img/HV_22.png" alt="" height="550">
				</section>
			</section>
			<section>
				<section>
					<h2>Пример создания ВМ 2</h2>
				</section>
				<section>
					<h3>PowerShell</h3>
					<img src="img/PVM_1.png" alt="">
				</section>
				<section>
					<h3>Установка служб Hyper-V</h3>
					<img src="img/PVM_2.png" alt="">
				</section>
				<section>
					<h3>Сетевые адаптеры</h3>
					<img src="img/PVM_3.png" alt="">
				</section>
				<section>
					<h3>Создание VMSwitch</h3>
					<img src="img/PVM_4.png" alt="">
				</section>
				<section>
					<h3>Установка типа</h3>
					<img src="img/PVM_5.png" alt="">
				</section>
				<section>
					<h3>Создание диска</h3>
					<img src="img/PVM_8.png" alt="">
				</section>
				<section>
					<h3>Создание ВМ</h3>
					<img src="img/PVM_9.png" alt="">
				</section>
				<section>
					<h3>Добавление DVD</h3>
					<img src="img/PVM_10.png" alt="">
				</section>
				<section>
					<h3>Привязка VMSwitch к ВМ</h3>
					<img src="img/PVM_11.png" alt="">
				</section>
				<section>
					<h3>Запуск ВМ</h3>
					<img src="img/PVM_12.png" alt="">
				</section>
				<section>
					<h3>Соединение с ВМ</h3>
					<img src="img/PVM_13.png" alt="">
				</section>
				<section>
					<h3>Остановка ВМ</h3>
					<img src="img/PVM_14.png" alt="">
				</section>
				<section>
					<h3>Результат</h3>
					<img src="img/PVM_15.png" alt="">
				</section>
			</section>
			<section>
				<section>
					<h2>Пример создания ВМ 3</h2>
				</section>
				<section>
					<h3>Создание новой ВМ</h3>
					<img src="img/SHV_1.png" alt="" height="550">
				</section>
				<section>
					<h3>Название и путь</h3>
					<img src="img/SHV_2.png" alt="" height="550">
				</section>
				<section>
					<h3>Выбор типа</h3>
					<img src="img/SHV_3.png" alt="" height="550">
				</section>
				<section>
					<h3>Размер ОП</h3>
					<img src="img/SHV_4.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройка сети</h3>
					<img src="img/SHV_5.png" alt="" height="550">
				</section>
				<section>
					<h3>Virtual Hard Disk</h3>
					<img src="img/SHV_6.png" alt="" height="550">
				</section>
				<section>
					<h3>Выбор образа диска</h3>
					<img src="img/SHV_7.png" alt="" height="550">
				</section>
				<section>
					<h3>Завершение создания ВМ</h3>
					<img src="img/SHV_8.png" alt="" height="550">
				</section>
				<section>
					<h3>Установка ОС</h3>
					<img src="img/SHV_9.png" alt="" height="550">
				</section>
				<section>
					<h3>Лицензионное соглашение</h3>
					<img src="img/SHV_11.png" alt="" height="550">
				</section>
				<section>
					<h3>Создание раздела</h3>
					<img src="img/SHV_12.png" alt="" height="550">
				</section>
				<section>
					<h3>Установка ОС</h3>
					<img src="img/SHV_13.png" alt="" height="550">
				</section>
				<section>
					<h3>Результат установки</h3>
					<img src="img/SHV_14.png" alt="" height="550">
				</section>
				<section>
					<h3>Администрирование ОС</h3>
					<img src="img/SHV_15.png" alt="" height="550">
				</section>
				<section>
					<h3>Общие папки</h3>
					<img src="img/SHV_17.png" alt="">
				</section>
			</section>
			<!-- Содержимое лекции -->
			<section>
				<h2 class="header-hide">Спасибо за внимание</h2>
				<img src="img/thanks.jpg" alt="" height="600">
			</section>
		</div>
	</div>
	<aside id="presentable-icon" class="revealjs">
		<a title="Содержание лекции" href="#/0/1">
			<i class="fa fa-list-ul fa-2x"></i>
		</a>
	</aside>
	<script src="../../js/bundle.min.js"></script>
</body>

</html>