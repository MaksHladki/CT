<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">
	<title>Название лекции</title>
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="Maks Hladki">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="../../css/bundle.min.css">
	<!--[if lt IE 9]>
		<script src="../../js/html5shiv.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<section>
					<h1>Название лекции</h1>
					<h3>Разработка динамичесих веб приложений</h3>
					<p>
						<small>Гладкий Максим Валерьевич / <a href="https://github.com/MaksHladki">github:MaksHladki</a></small>
					</p>
				</section>
				<section>
					<h2>Содержание лекции</h2>
					<nav id="presentable-toc" class="table-content"></nav>
				</section>
			</section>
			<!-- Содержимое лекции -->
			<section>
				<h1>SQL Azure</h1>
			</section>
			<section>
				<section>
					<h2>Определение от Microsoft</h2>
					<blockquote>
						База данных SQL — это реляционная служба баз данных в Microsoft Cloud на основе популярного ядра Microsoft SQL Server, которая
						подходит для выполнения критически важных рабочих нагрузок. База данных SQL обеспечивает прогнозируемую производительность
						на нескольких уровнях службы, динамическую масштабируемость без простоев, встроенную непрерывность бизнес-процессов
						и защиту данных
					</blockquote>
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Развитие и адаптация - динамически увеличивает производительность, надежность и безопасность данных с минимальными
							усилиями со стороны клиента</li>
						<li>Обнаружение угроз и оповещения - встроенный поведенческий анализ, оповещения в реальном времени, настраиваемые политики
							угроз, журнал аудита</li>
						<li>Автоматическая настройка - непрерывный анализ типовых действий приложений, адаптивная настройка и автоматическая коррекция
							производительности
						</li>
						<li>Своевременные рекомендации - БД отслеживает каждый запрос и оценивать его длительность, частоту и затраты ресурсов.
							Автоматические алгоритмы корректируют настройки базы данных оптимальным образом в соответствии с характером запросов</li>
					</ul>
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Не требует администрирования - автоматическое резервное копирование, аварийное восстановление, обслуживание инфраструктуры,
							исправления систем безопасности, обновления компонентов</li>
						<li>Использование пулов эластичных баз данных для создания более эффективных мультитенантных приложений</li>
						<li>Управляемое автомасштабирование - пулы автоматически в режиме реального времени масштабируют производительность и емкость
							хранилища для эластичных баз данных</li>
						<li>Простота освоения - можно использовать привычные инструменты: cheetah, sql-cli и VS Code, Visual Studio, SQL Server
							Management Studio
						</li>
						<li>Управление через портал, PowerShell, REST API</li>
					</ul>
				</section>
				<section>
					<h3>Уровни служб</h3>
					<ul>
						<li><span class="highlight-blue">Базовый</span> - подходит для небольшой базы данных, для которой в определенный момент
							времени обычно выполняется одна активная операция (БД для разработки или тестирования, редко используемое приложение)</li>
						<li><span class="highlight-blue">Стандартный</span> - оптимальный вариант для облачных приложений с низкими или средними
							требованиями к производительности операций ввода-вывода, поддерживающий несколько параллельных запросов (веб-приложения)</li>
						<li><span class="highlight-blue">Премиум</span> - большой объем транзакций с высокими требованиями к производительности
							операций ввода-вывода. Поддерживается параллельная работа множества пользователей (БД для поддержки критически важных
							приложений)
						</li>
					</ul>
				</section>
				<section>
					<h3>Сравнение</h3>
					<table>
						<tr>
							<td>Максимальный размер БД</td>
							<td>2 ГБ</td>
							<td>250 ГБ</td>
							<td>1 ТБ</td>
						</tr>
						<tr>
							<td>Максимальный размер хранилища</td>
							<td>117 ГБ</td>
							<td>750 ГБ</td>
							<td>1200 ГБ</td>
						</tr>
						<tr>
							<td>Число баз в пуле</td>
							<td>400</td>
							<td>400</td>
							<td>50</td>
						</tr>
						<tr>
							<td>Период хранения резервной копии</td>
							<td>7 дней</td>
							<td>35 дней</td>
							<td>35 дней</td>
						</tr>
					</table>
				</section>
				<section>
					<h3>Правила масштабирования от Microsoft</h3>
					<table>
						<thead>
							<tr>
								<th>Тип</th>
								<th>Пользователи</th>
								<th>Размер БД</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Basic</td>
								<td>5 </td>
								<td>720 МБ</td>
							</tr>
							<tr>
								<td>Standard (S0)</td>
								<td>10</td>
								<td> 1 GB</td>
							</tr>
							<tr>
								<td>Standard (S1)</td>
								<td>20 </td>
								<td>2,1 ГБ</td>
							</tr>
							<tr>
								<td>Standard (S2)</td>
								<td>50 </td>
								<td>7,1 ГБ</td>
							</tr>
							<tr>
								<td>Premium (P1)</td>
								<td>100 </td>
								<td>14 ГБ</td>
							</tr>
							<tr>
								<td>Premium (P2)</td>
								<td>200 </td>
								<td>28 ГБ</td>
							</tr>
							<tr>
								<td>Premium (P6/P3)</td>
								<td>800 </td>
								<td>114 ГБ</td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>
			<section>
				<h2>Возможности SQL Azure</h2>
				<ul>
					<li>Может представлять собой отдельную базу данных с собственным набором ресурсов (DTU)</li>
					<li>Может входить в состав пула баз данных, в котором набор ресурсов используется совместно (eDTU)</li>
					<li>Может входить в состав масштабируемого набора сегментированных баз данных, которые могут быть отдельными базами данных
						или частью пула</li>
					<li>Может входить в состав набора баз данных, использующихся в шаблоне разработки для мультитенантных приложений SaaS, которые
						могут быть отдельными базами данных или быть частью пула (или этот набор может иметь смешанную конфигурацию)</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Поддерживаемые функции</h2>
					<!-- https://github.com/Microsoft/azure-docs.ru-ru/blob/master/articles/sql-database/sql-database-features.md-->
					<img src="img/fight_logo.png" alt="">
				</section>
				<section>
					<h3>Часть 1</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Активная георепликация</td>
								<td>-</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Постоянное шифрование</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Группы доступности AlwaysOn</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Присоединение базы данных</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Роли приложений</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Автомасштабирование</td>
								<td>-</td>
								<td>+</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Часть 2</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Azure Active Directory</td>
								<td>-</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Фабрика данных Azure</td>
								<td>-</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Аудит</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Инструкции BACKUP и RESTORE</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Встроенные функции</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Среда CLR</td>
								<td>+</td>
								<td>-</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Часть 3</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Курсоры</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Сжатие данных</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Зеркальное отображение базы данных</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Моментальные снимки базы данных</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Инструкции языка DDL</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Триггеры DDL</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Часть 4</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Инструкции языка DML</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Триггеры DML</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>эластичные пулы</td>
								<td>-</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Файловый поток</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Функции</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Поддержка данных JSON</td>
								<td>+</td>
								<td>+</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Часть 5</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Управление на основе политик</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Предикаты</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Безопасность на уровне строк</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Семантический поиск</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Порядковые номера</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Агент SQL Server</td>
								<td>+</td>
								<td>-</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section>
					<h3>Часть 6</h3>
					<table>
						<thead>
							<tr>
								<th>Компонент</th>
								<th>SQL Server</th>
								<th>SQL Azure</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>PowerShell</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Репликация SQL Server</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Хранимые процедуры</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Секционирование таблиц.</td>
								<td>+</td>
								<td>-/+</td>
							</tr>
							<tr>
								<td>Временные таблицы</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>XML-индексы</td>
								<td>+</td>
								<td>+</td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>
			<section>
				<section>
					<h2>Эластичеые пулы</h2>
				</section>
				<section>
					<h3>Определение от Microsoft</h3>
					<blockquote>
						Пулы эластичных БД SQL обеспечивают простое и экономически выгодное решение для управления целевыми показателями производительности
						для нескольких баз данных с совершенно разными и непредсказуемыми моделями функционирования
					</blockquote>
					<!--https://github.com/Microsoft/azure-docs.ru-ru/blob/master/articles/sql-database/sql-database-elastic-pool-guidance.md https://docs.microsoft.com/ru-ru/azure/sql-database/sql-database-elastic-pool-->
				</section>
				<section>
					<h3>Проблема распределения ресурсов</h3>
					<ol>
						<li>Подготовка избыточного количества ресурсов, соответствующего пиковой нагрузке (ведет к повышению затрат)</li>
						<li>Подготовка недостаточного количества ресурсов для экономии (ведет к снижению производительности и удовлетворенности
							клиентов во время пиковой нагрузки)</li>
					</ol>
					<blockquote>
						Пулы эластичных БД решают эту проблему, обеспечивая базы данных необходимыми ресурсами производительности, когда они нужны.
						Они предоставляют простой механизм распределения ресурсов в рамках прогнозируемого бюджета
					</blockquote>
				</section>
				<section>
					<h3>Принцип работы</h3>
					<ul>
						<li>
							Пулу предоставляется заданное количество единиц eDTU по фиксированной цене
						</li>
						<li>Отдельным базам данных в пуле предоставляется возможность гибкого автоматического масштабирования в рамках заданных
							параметров
						</li>
						<li>В условиях интенсивной нагрузки база данных может использовать дополнительные единицы eDTU для удовлетворения потребности
							в ресурсах</li>
						<li>При небольших нагрузках базы данных используют меньше ресурсов (eDTU), а при отсутствии нагрузок не используют их вовсе.
						</li>
						<li>Подготовка ресурсов для всего пула, а не для отдельной базы данных упрощает задачи управления. Кроме того, используя
							пул, вы можете спрогнозировать расходы</li>
						<li>Добавить дополнительные единицы eDTU в существующий пул можно без простоя баз данных</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Eдиницы передачи данных (DTU)</h2>
				</section>
				<section>
					<h2>Определение</h2>
					<blockquote>
						DTU — это единица измерения ресурсов, которые гарантированно доступны любой отдельной базе данных SQL Azure с определенным
						уровнем производительности в рамках уровня службы для отдельных баз данных.
					</blockquote>
				</section>
				<section>
					<h3>Структура единицы</h3>
					<ul>
						<li>Показатели ЦП</li>
						<li>Показатели памяти</li>
						<li>Показатели ввода-вывода данных</li>
						<li>Показатели ввода-вывода журналов транзакций</li>
					</ul>
				</section>
				<section>
					<h3>Повышение произодительности БД</h3>
					<blockquote>
						Повысить производительность базы данных означает удвоить количество ресурсов, доступных для этой базы данных
					</blockquote>
					<p class="text">
						Например, база данных P11 уровня "Премиум" с 1750 единицами DTU обеспечивает в 350 раз больше вычислительной мощи, чем база
						данных уровня "Базовый" с 5 единицами DTU
					</p>
				</section>
				<section>
					<h3>Пример</h3>
					<img src="img/single_db_dtus.png" alt="" height="500">
				</section>
				<section>
					<h3>Как выбрать нужный тип на основе DTU?</h3>
					<ul>
						<li>Использовать калькулятр</li>
						<li>Использовать PowerShell-скрипт</li>
						<li>Использовать Command Line Utility</li>
					</ul>
				</section>
			</section>
			<section>
				<section>
					<h2>Eдиницы передачи данных (eDTU)</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						eDTU — это единица измерения набора ресурсов (DTU), которые совместно используют несколько баз данных на сервере SQL Azure.
						Эти базы данных вместе называются пулом эластичных БД
					</blockquote>
					<blockquote>
						Пулы эластичных БД обеспечивают простое и экономически выгодное решение для управления целевыми показателями производительности
						для нескольких баз данных с совершенно разными и непредсказуемыми моделями функционирования
					</blockquote>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Пулу предоставляется заданное количество единиц eDTU по фиксированной цене</li>
						<li>Отдельным БД в эластичном пуле предоставляется возможность гибкого автоматического масштабирования в рамках заданных
							границ
						</li>
						<li>БД, на которые приходится значительная нагрузка, могут потреблять больше eDTU, чтобы обслужить имеющийся спрос, при
							этом базы данных с меньшей нагрузкой смогут потреблять меньше eDTU</li>
						<li>Если у базы данных прогнозируемо низкие показатели использования ресурсов, ее можно переместить из пула и настроить
							в качестве отдельной базы данных с прогнозируемым объемом ресурсов, который ей необходим</li>
					</ul>
				</section>
				<section>
					<h3>Пример</h3>
					<img src="img/sqldb_elastic_pools.png" alt="" height="500">
				</section>
			</section>
			<section>
				<section>
					<h2>Эластичные запросы</h2>
					<blockquote>
						С помощью функции запросов к эластичной базе данных можно выполнять запросы Transact-SQL для обращения сразу к нескольким
						базам данных в базе данных SQL Azure. Эта возможность позволяет создавать межбазовые запросы для доступа к удаленным
						таблицам. С помощью этой функции можно разворачивать запросы до уровней большого объема данных в базе данных SQL и
						визуализировать результаты в отчетах по бизнес-аналитике
					</blockquote>
				</section>
				<section>
					<h3>Преимущества эластичных запросов</h3>
					<ul>
						<li>Выполнение запросов к нескольким базам данных SQL Azure на языке T-SQL
						</li>
						<li>Доступно для всех тарифных планов без ограничения</li>
						<li>Эластичные запросы к удаленным базам данных теперь могут отправлять параметры SQL для выполнения
						</li>
						<li>Выполнение вызовов удаленных хранимых процедур или удаленных функций с помощью процедуры sp_execute _remote</li>
						<li>Эластичные запросов позволют внешним таблицам ссылаться на удаленные таблицы с разными именами схем или таблиц</li>
					</ul>
				</section>
				<section>
					<h3>Схема работы</h3>
					<img src="img/overview_sql.png" alt="">
					<!-- https://docs.microsoft.com/ru-ru/azure/sql-database/sql-database-elastic-query-overview -->
				</section>
				<section>
					<h2>Способы применения элемтичных запросов</h2>
					<ul>
						<li>Вертикальное секционирование — межбазовые запросы (топология 1): вертикальное разделение данных между несколькими базами
							данных в рамках одного уровня. Например, все таблицы, связанные с данными инвентаризации, хранятся в одной базе данных,
							а таблицы, связанные с учетом, — в другой</li>
						<li>Горизонтальное секционирование — сегментирование (топология 2): горизонтальное разделение данных для распределения
							строк в рамках масштабируемого уровня данных. При таком подходе схемы всех включенных баз данных являются идентичными.
							Сегментирование может выполняться с помощью (1) библиотеки средств эластичной базы данных или (2) как самостоятельное
							сегментирование
						</li>
					</ul>
				</section>
				<section>
					<h3>Пример вертикального секционирования</h3>
					<img src="img/verticalpartitioning.png" alt="">
				</section>
				<section>
					<h3>Пример горизонтального секционирования</h3>
					<img src="img/horizontalpartitioning.png" alt="">
				</section>
				<section>
					<h3>Пример запроса</h3>
					<pre>
						<code class="hljs">
select  
     w_id as warehouse,
     o_c_id as customer,
     count(*) as cnt_orderline,
     max(ol_quantity) as max_quantity,
     avg(ol_amount) as avg_amount, 
     min(ol_delivery_d) as min_deliv_date
from warehouse 
join orders 
on w_id = o_w_id
join order_line 
on o_id = ol_o_id and o_w_id = ol_w_id 
where w_id > 100 and w_id < 200 
group by w_id, o_c_id 
						</code>
					</pre>
				</section>
			</section>
			<section>
				<section>
					<h2>Пример</h2>
				</section>
				<section>
					<h3>Панель управления</h3>
					<img src="img/sql_1.png" alt="">
				</section>
				<section>
					<h3>Создание БД</h3>
					<img src="img/sql_2.png" alt="">
				</section>
				<section>
					<h3>Панель управления экземпляров</h3>
					<img src="img/sql_3.png" alt="">
				</section>
				<section>
					<h3>Выбор региона</h3>
					<img src="img/sql_4.png" alt="">
				</section>
				<section>
					<h3>Строка подключения</h3>
					<img src="img/sql_5.png" alt="">
				</section>
			</section>
			<section>
				<h1>Azure DocumentDB</h1>
			</section>
			<section>
				<section>
					<h2>Определение от Microsoft</h2>
					<blockquote>
						Полностью управляемая служба баз данных NoSQL, созданная для быстрой и прогнозируемой работы, высокой доступности, гибкого
						масштабирования, глобального распространения данных и простоты разработки
					</blockquote>
					<blockquote>
						DocumentDB — это служба баз данных NoSQL без схемы, обеспечивающая широкие возможности запросов SQL со знакомым синтаксисом,
						согласованность и небольшую продолжительность задержек для данных JSON: 99 % операций чтения обрабатываются менее 10
						миллисекунд, а 99 % операций записи — менее 15 миллисекунд
					</blockquote>
				</section>
				<section>
					<h3>Схема работы</h3>
					<img src="img/documentdb.png" alt="" height="500">
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Гибко масштабируемые пропускная способность и объем хранения - база данных легко масштабируется в соответствии с потребностями,
							хранятся на SSD, поддерживает контейнеры для хранения данных JSON, практически неограниченный размеров хранилища и
							пропускная способность
						</li>
						<li>Репликация между несколькими регионами - позволяет разрабатывать приложения, которым требуется глобальный доступ к
							данным, при этом обеспечивая компромиссы между согласованностью, доступностью и производительностью с соответствующими
							гарантиями
						</li>
						<li>Классический SQL-синтаксис</li>
						<li>Безблокировочную технологию индексирования с высокой степенью параллелизма и структурированием журналов для автоматического
							индексирования содержимого JSON документов</li>
					</ul>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Настраиваемые уровни согласованности — 4 уровня согласованности: strong (сильная), bounded-staleness (ограниченная),
							session (уровень сеанса) и eventual (согласованная в конечном счете)</li>
						<li>Полная управляемость - отсутствие необходимости управления БД и вычислительными ресурсами. Автоматическое сохранение
							и защита от региональных сбоев
						</li>
						<li>
							Открытая структура - получение доступа ко всей функциональности БД (CRUD, запросы и обработку JS) через REST API
						</li>
						<li>Выполнение операторов (DML) из кода JS в изолированной транзакции</li>
						<li>Выполнение JS в БД — реализация логики приложения в виде хранимых процедур, триггеров и пользовательских функций (UDF),
							использующих стандартный JS</li>
					</ul>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Простая и открытую модель RESTful API</li>
						<li>Все ресурсы в DocumentDB моделируются и хранятся в виде документов JSON</li>
						<li>Ресурсы управляют элементами (документы JSON и метаданные) и потоками (коллекции элементов). Наборы элементов содержатся
							внутри соответствующих потоков</li>
						<li>Учетная запись базы данных состоит из набора баз данных, каждая из которых содержит несколько коллекций
						</li>
						<li>Коллекция содержит хранимые процедуры, триггеры, определяемые пользователем функции, документы и соответствующие вложения
						</li>
						<li>БД включает связанных с ней пользователей, каждый из которых обладает набором разрешений для доступа к коллекциям,
							хранимым процедурам, триггерам, определяемым пользователем функциям, документам и вложениям</li>
					</ul>
				</section>
				<section>
					<h3>Запросы SQL</h3>
					<ul>
						<li>Специальный итерфейс для запроса документов JSON</li>
						<li>Язык поддерживает грамматику подмножества ANSI SQL и добавляет глубокую интеграцию объектов, массивов, создания объектов
							и вызова функций JS</li>
						<li>Предоставляет свою модель запросов без явных схем или подсказок индексации от разработчика</li>
						<li>Пользовательские функции (UDF) могут быть зарегистрированы в DocumentDB, и ссылаться на них можно как на часть SQL-запроса,
							тем самым расширяя грамматику для поддержки логики пользовательского приложения</li>
						<li>Пользовательские функции записываются в виде программ JS и выполняются в базе данных</li>
						<li>Для .NET DocumentDB предоставляет поставщик запросов LINQ в составе пакета SDK</li>
					</ul>
				</section>
				<section>
					<h3>Транзакции и выполнение JavaScript</h3>
					<ul>
						<li>JavaScript может быть зарегистрирован для выполнения в качестве триггера, хранимой процедуры или пользовательской функции
							(UDF).
						</li>
						<li>Триггеры и хранимые процедуры могут создавать, читать, обновлять и удалять документы, в то время как определяемые пользователем
							функции выполняются в рамках логики выполнения запроса без доступа на запись в коллекции. </li>
						<li>Выполнение JavaScript в DocumentDB моделируется по принципам, поддерживаемым реляционными СУБД, с JavaScript в качестве
							современной замены Transact-SQL.</li>
						<li> Вся логика JavaScript выполняется в транзакции ACID с изоляцией моментального снимка. В ходе его исполнения, если код
							JavaScript генерирует исключение, то вся транзакция прерывается.</li>
					</ul>
				</section>
				<section>
					<h3>Коллекции</h3>
					<blockquote>
						Коллекция DocumentDB — контейнер для документов JSON, является единицей масштабирования для транзакций и запросов
					</blockquote>
				</section>
				<section>
					<ul>
						<li>Гибкое хранилище документов на базе SSD - коллекция является гибкой, автоматически увеличивается и уменьшается по мере
							добавления или удаления документов</li>
						<li>Автоматическое секционирование - число секций в коллекции определяется по размеру хранилища и пропускной способности,
							выделенных для коллекции</li>
						<li>Автоматическое индексирование — автоматическая индексация документов, не требующая указания схемы или вторичных индексов
							и доступна благодаря оптимизации записи, безблокировочной и оптимизированной журнально-структурированной технологии
							обслуживания индексов</li>
						<li>Настраиваемые политики индексирования - позволяет настроить соотношения объема и производительности для интервала и
							хэш-запросов для конкретных шаблонов пути. Можно отключать автоматическое индексирование и добавлять только выбранные
							документы в индекс</li>
					</ul>
				</section>
				<section>
					<ul>
						<li>Изначально секционирует данные для обеспечения высокой доступности и масштабируемости</li>
						<li>Хранилище на базе SSD с низкой задержкой и временем ответа</li>
						<li>Поддержка уровней согласованности, таких как bounded-staleness (ограниченная), session (уровень сеанса) и eventual
							(согласованная в конечном счете), обеспечивает оптимальное соотношение затрат и производительности</li>
						<li>Гибкая модель ценообразования, в которой место для хранения и пропускная способность измеряются независимо
						</li>
						<li>Модель зарезервированной пропускной способности DocumentDB позволяет вести учет по количеству операций чтения и записи,
							а не по ресурсам ЦП, памяти и операций ввода-вывода базового оборудования</li>
						<li>Структура DocumentDB допускает масштабирование для огромного числа запросов, измеряемого миллиардами запросов в день</li>
					</ul>
				</section>
				<!--<section>
					https://github.com/Microsoft/azure-docs.ru-ru/blob/master/articles/documentdb/documentdb-sql-query.md
				</section>-->
			</section>
			<section>
				<section>
					<h2>Пример</h2>
				</section>
				<section>
					<h3>Структура документа</h3>
					<pre>
						<code class="hljs">
{
    "id": "AndersenFamily",
    "lastName": "Andersen",
    "parents": [
       { "firstName": "Thomas" },
       { "firstName": "Mary Kay"}
    ],
    "children": [
       {
           "firstName": "Henriette Thaulow", "gender": "female", "grade": 5,
           "pets": [{ "givenName": "Fluffy" }]
       }
    ],
    "address": { "state": "WA", "county": "King", "city": "seattle" },
    "creationDate": 1431620472,
    "isRegistered": true
}
						</code>
					</pre>
				</section>
				<section>
					<h3>Запрос 1</h3>
					<pre>
						<code class="hljs">
SELECT * FROM Families f 
         WHERE f.id = "AndersenFamily";
						</code>
					</pre>
				</section>
				<section>
					<h3>Результат</h3>
					<pre>
						<code class="hljs">
[{
    "id": "AndersenFamily",
    "lastName": "Andersen",
    "parents": [
       { "firstName": "Thomas" },
       { "firstName": "Mary Kay"}
    ],
    "children": [
       {
           "firstName": "Henriette Thaulow", "gender": "female", "grade": 5,
           "pets": [{ "givenName": "Fluffy" }]
       }
    ],
    "address": { "state": "WA", "county": "King", "city": "seattle" },
    "creationDate": 1431620472,
    "isRegistered": true
}]
						</code>
					</pre>
				</section>
				<section>
					<h3>Запрос 2</h3>
					<pre>
						<code class="hljs">
SELECT {"Name":f.id, "City":f.address.city} AS Family 
       FROM Families f 
       WHERE f.address.city != f.address.state
						</code>
					</pre>
				</section>
				<section>
					<h3>Результат</h3>
					<pre>
						<code class="hljs">
[{
    "Family": {
        "Name": "AndersenFamily", 
        "City": "seattle"
    }
}]
						</code>
					</pre>
				</section>
			</section>
			<section>
				<section>
					<h2>Пример</h2>
				</section>
				<section>
					<h3>Панель управления экземплярами</h3>
					<img src="img/nosql_1.png" alt="">
				</section>
				<section>
					<h3>Создание БД</h3>
					<img src="img/nosql_2.png" alt="">
				</section>
				<section>
					<h3>Панель упраления экземпляром</h3>
					<img src="img/nosql_3.png" alt="">
				</section>
				<section>
					<h3>Выбор SDK</h3>
					<img src="img/nosql_4.png" alt="">
				</section>
				<section>
					<h3>Создание коллекции</h3>
					<img src="img/nosql_5.png" alt="">
				</section>
				<section>
					<h3>Упраление коллекцией</h3>
					<img src="img/nosql_6.png" alt="">
				</section>
				<section>
					<h3>Ключи</h3>
					<img src="img/nosql_7.png" alt="">
				</section>
			</section>
			<section>
				<h1>Virtual Network</h1>
			</section>
			<section>
				<section>
					<h2>Виртуальная сеть Azure</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Виртуальная сеть (VNet) Azure — это представление сети в облаке. Это логическая изоляция облака Azure, выделенного по подписке
						подписке с возможностью полного контроля блоков IP-адресов, параметров DNS, политик безопасности и таблиц маршрутизации.
					</blockquote>
				</section>
				<section>
					<h3>Схема локальной сети</h3>
					<img src="img/classic_network.png" alt="" height="500">
				</section>
				<section>
					<h3>Схема виртуальной сети Azure</h3>
					<img src="img/azure_network.png" alt="" height="500">
				</section>
			</section>
			<section>
				<h2>Преимущества виртуальных сетей</h2>
				<ul>
					<li>Изоляция - сети изолированы друг от друга. Позволяет создавать отдельные сети для разработки, тестирования и эксплуатации,
						использующие одинаковые блоки адресов CIDR</li>
					<li>Доступ к Интернету - интернет доступен по умолчанию для ВМ IaaS и экземпляров PaaS. Контроль доступа на основе групп
						безопасности сети</li>
					<li>Доступ в виртуальной сети - PaaS и IaaS могут запускаться в одной виртуальной сети и подключаться друг к другу с помощью
						частных IP, даже если они находятся в разных подсетях, без шлюзов, пиринга и общедоступных IP</li>
					<li>Разрешение имен - автоматическое разрешение имен. Можно развернуть собственные DNS-серверы
					</li>
					<li>Подключение - виртуальные сети подключаются к локальным ЦОД через VPN "сеть—сеть" или Azure ExpressRoute</li>
				</ul>
			</section>
			<section>
				<h2>Типы IP-адресов в виртуальной сети</h2>
				<ul>
					<li>Общедоступные - позволяют ресурсам Azure подключаться к Интернету и другим общедоступным службам Azure, таким как кэш
						Redis для Azure и концентраторы событий Azure</li>
					<li>Частные - обеспечивают связь между ресурсами в виртуальной сети, а также теми, которые подключаются через VPN, без использования
						IP-адресов с поддержкой маршрутизации в Интернет</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Общедоступные IP-адреса</h2>
					<ul>
						<li>Виртуальные машины</li>
						<li>Балансировщики нагрузки, доступные в Интернете</li>
						<li>VPN-шлюзы</li>
						<li>Шлюзы приложений</li>
					</ul>
				</section>
				<section>
					<h3>Способ выделения</h3>
					<ul>
						<li>Динамический (по умолчанию) - IP-адрес выделяется когда клиент запускает (или создает) связанный ресурс (ВМ, балансировщик
							нагрузки и т.д.). Если остановить или удалить ресурс, IP-адрес освобождается. При перезапуске ресурса адрес изменяется</li>
						<li>Статический - IP-адрес назначается немедленно и освобождается только тогда, когда клиент удаляете ресурс или задаете
							динамический способ выделения. Используется, если IP-адрес связанного ресурса не должен изменяться</li>
					</ul>
				</section>
				<section>
					<h3>Причины использования статических адресов</h3>
					<ul>
						<li>Конечным пользователям необходимо обновлять правила брандмауэра для взаимодействия с ресурсами Azure</li>
						<li>Разрешение DNS-имени, в рамках которого изменение IP-адреса влечет за собой необходимость обновить записи A</li>
						<li>Ресурсы Azure взаимодействуют с другими веб-приложениями или службами, которые используют модель безопасности, основанную
							на IP-адресах</li>
						<li>Клиент использует SSL-сертификаты, связанные с IP-адресом</li>
					</ul>
				</section>
				<section>
					<h3>Ценовая политика</h3>
					<blockquote>
						В большинстве случаев общедоступные IP-адреса бесплатны. Существует номинальная плата за использование дополнительных или
						статических общедоступных IP-адресов
					</blockquote>
				</section>
				<section>
					<h3>Итого</h3>
					<table>
						<thead>
							<tr>
								<th>Ресурс</th>
								<th>Связанный IP</th>
								<th>Дин.</th>
								<!-- динамический и статический -->
								<th>Ст.</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Виртуальная машина</td>
								<td>Сетевой интерфейс</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Подсистема балансировки нагрузки</td>
								<td>Конфигурация клиентской части </td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>VPN-шлюз</td>
								<td>Конфигурация IP шлюза</td>
								<td>+</td>
								<td>-</td>
							</tr>
							<tr>
								<td>Шлюз приложений</td>
								<td>Конфигурация клиентской части</td>
								<td>+</td>
								<td>-</td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>
			<section>
				<section>
					<h2>Частные IP-адреса</h2>
					<blockquote>
						Частный IP-адрес выделяется из диапазона адресов подсети, к которой подключен ресурс
					</blockquote>
					<ul>
						<li>Виртуальные машины</li>
						<li>Внутренние балансировщики нагрузки</li>
						<li>Шлюзы приложений</li>
					</ul>
				</section>
				<section>
					<h3>Способ выделения</h3>
					<ul>
						<li>Динамический (по умолчанию) - IP-адрес выделяется из подсети ресурса через протокол DHCP. Во время остановки и запуска
							ресурса этот IP-адрес изменяется</li>
						<li>Статический - необходимо указать допустимый IP-адрес, который является частью подсети ресурса. Не изменяется при перезапуске
							ресурса
						</li>
					</ul>
				</section>
				<section>
					<h3>Причины использования частных статических адресов</h3>
					<ul>
						<li>Для виртуальных машин, работающих в качестве контроллеров домена или DNS-серверов</li>
						<li>Для ресурсов, в которых правилам брандмауэра нужно использовать IP-адреса</li>
						<li>Для ресурсов, доступ к которым другие приложения и другие ресурсы получают через IP-адрес</li>
					</ul>
				</section>
				<section>
					<table>
						<thead>
							<tr>
								<th>Ресурс</th>
								<th>Связанный IP</th>
								<th>Дин.</th>
								<th>Ст.</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Виртуальная машина</td>
								<td>Сетевой интерфейс</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>Подсистема балансировки нагрузки</td>
								<td>Конфигурация клиентской части</td>
								<td>+</td>
								<td>+</td>
							</tr>
							<tr>
								<td>шлюзу приложений</td>
								<td>Конфигурация клиентской части</td>
								<td>+</td>
								<td>+</td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>
			<section>
				<section>
					<h3>Подсети</h3>
					<blockquote>
						Подсеть — это диапазон IP-адресов в виртуальной сети. Виртуальную сеть можно разделить на несколько подсетей для организационного
						удобства и безопасности. Имеется механизм настройки таблиц маршрутизации и групп безопасности сети для подсети
					</blockquote>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Автоматическое связывание - ВМ и другие компоненты связываются между собой атоматически даже если они находяься в разных
							подсетях, не нужно указывать шлюз</li>
						<li>Автоматическое подключение через Интернет</li>
						<li>Атоматическое подключение в локальной сети (при наличии гибридного подключения Azure к локальному ЦОД)</li>
						<li>Ипользование системных маршрутов для определения передачи IP-трафика</li>
					</ul>
				</section>
				<section>
					<h3>Случаи применение системных маршрутов</h3>
					<ul>
						<li>В одной и той же подсети</li>
						<li>Из одной подсети в другую в виртуальной сети</li>
						<li>Из виртуальных машин в Интернет</li>
						<li>Из одной виртуальной сети в другую через VPN-шлюз</li>
						<li>Из виртуальной сети в локальную сеть через VPN-шлюз</li>
					</ul>
				</section>
				<section>
					<h3>Правила системных марсшрутов</h3>
					<ul>
						<li>Локальное правило виртуальной сети - правило создается автоматически для каждой подсети в виртуальной сети. Указывает,
							что существует прямая связь между виртуальными машинами в виртуальной сети, без промежуточного следующего прыжка
						</li>
						<li>Правило локальной среды - правило применяется для всего трафика, предназначенного для локального диапазона адресов;
							использует VPN-шлюз в качестве назначения следующего прыжка</li>
						<li>Правило Интернета - правило обрабатывает весь трафик, направляемый в общедоступный Интернет (префикс адреса 0.0.0.0/0).
							Использует шлюз Интернета инфраструктуры в качестве следующего прыжка для всего трафика, предназначенного для Интернета
						</li>
					</ul>
				</section>
				<section>
					<h3>Пример 1</h3>
					<img src="img/system_network.png" alt="" height="500">
					<!-- На следующем рисунке показан пример определяемых пользователем маршрутов и IP-пересылки для принудительной отправки пакетов, передаваемых из одной подсети во вторую подсеть, в виртуальным модуль в третьей подсети. -->
				</section>
				<section>
					<h3>Пример 2</h3>
					<img src="img/user_network.png" alt="" height="500">
				</section>
				<section>
					<h3>Пользовательский маршрут</h3>
					<blockquote>
						Принудительное туннелирование для доступа к Интернету виртуальных устройств в среде Azure через локальную сеть клиента
					</blockquote>
					<blockquote>
						Инфраструктура предоставляет возможности пользователю создавать свою таблицу маршрутов. Можно использовать несколько таблиц
						маршрутов, и одна таблица маршрутов может быть связана с одной или несколькими подсетями. НО каждая подсеть может быть
						связана только с одной таблицей маршрутов!
					</blockquote>
				</section>
				<section>
					<h3>Принцип работы</h3>
					<ol>
						<li>Пока c подсетью не связана таблица маршрутов, она использует системные маршруты</li>
						<li>После установления связи маршрутизация выполняется по совпадению наиболее длинного префикса (LPM) среди определяемых
							пользователем маршрутов и системных маршрутов</li>
						<li>При наличии более одного маршрута с одинаковыми совпадающими значениями LPM маршрут выбирается по источнику в следующем
							порядке: 1) определяемый пользователем маршрут; 2) маршрут BGP (если используется ExpressRoute); 3) Системные маршруты</li>
					</ol>
				</section>
			</section>
			<section>
				<section>
					<h2>Пиринг</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Пиринговая связь между виртуальными сетями — механизм подключения между двумя виртуальными сетями, находящимися в одном регионе,
						через магистральную сеть Azure. После создания пиринговой связи две виртуальные сети выглядят как одна при любом подключении.
						Они по-прежнему управляются как отдельные ресурсы, но теперь находящиеся в них виртуальные машины могут взаимодействовать
						друг с другом напрямую через частные IP-адреса
					</blockquote>
				</section>
				<section>
					<h3>Преимущества</h3>
					<ul>
						<li>Подключение между ресурсами в разных виртуальных сетях, характеризующееся низкой задержкой и высокой пропускной способностью</li>
						<li>Возможность использовать ресурсы, такие как сетевые устройства и VPN-шлюзы, в качестве транзитных точек в пиринговой
							виртуальной сети</li>
						<li>Возможность подключения виртуальной сети, в которой используется модель Azure Resource Manager, к виртуальной сети,
							в которой используется классическая модель развертывания, с обеспечением полной связи между ресурсами в этих виртуальных
							сетях
						</li>
					</ul>
				</section>
				<section>
					<h3>Требования</h3>
					<ul>
						<li>Две виртуальные сети должны находиться в одном регионе</li>
						<li>Для настройки пиринговой связи пространства IP-адресов используемых виртуальных сетей не должны перекрываться</li>
						<li>Пиринговая связь устанавливается между двумя виртуальными сетями. Производные переходные связи не поддерживаются
							<!--(А имеет свзяь с B, B - с С, A не имеет свзяь с С)-->
						</li>
						<li>Пиринговую связь можно установить между виртуальными сетями в двух разных подписках, если ее разрешает привилегированный
							пользователь обеих подписок и подписки связаны с одним и тем же клиентом Active Directory</li>
						<li>Для обмена данными между ВМ в пиринговых виртуальных сетях нет дополнительных ограничений пропускной способности, НО
							объем передаваемого трафика ограничивается размером ВМ</li>
					</ul>
				</section>
				<section>
					<h3>Пример</h3>
					<img src="img/piring.png" alt="">
				</section>
			</section>
			<section>
				<section>
					<h2>Сетевые интерфейсы</h2>
				</section>
				<section>
					<h3>Определение</h3>
					<blockquote>
						Сетевой интерфейс обеспечивает взаимодействие между виртуальной машиной и сетью с базовым программным обеспечением. В этой
						статье описывается сетевой интерфейс и его применение в рамках модели развертывания Azure Resource Manager.
					</blockquote>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Это ресурс, который можно создать, настроить, удалить</li>
						<li>При создании должен быть подключен к одной подсети в одной виртуальной сети. Для созданного интерфейса можно изменить
							подсеть, но нельзя изменить виртуальную сеть</li>
						<li>Имеет назначенное имя, которое нельзя изменить после создания. Имя должно быть уникальным в пределах группы ресурсов
							Azure, но не обязательно уникальным в пределах подписки, расположения Azure или виртуальной сети, к которой он подключен.
							В одной подписке может быть создано несколько интерфейсов</li>
						<li>Может быть подключен к виртуальной машине, но только к одной и обязательно созданной в том же расположении, что и сам
							сетевой интерфейс</li>
					</ul>
				</section>
				<section>
					<h3>Особенности</h3>
					<ul>
						<li>Имеет MAC-адрес, который закрепляется за сетевым интерфейсом до тех пор, пока он подключен к виртуальной машине. Сохраняется
							при перезапуске ВМ (с помощью функций ОС) или при остановке (освобождении) с последующим запуском через портал</li>
						<li>Должен иметь один основной частный (статический или динамический) IPv4</li>
						<li>Может иметь один присвоенный общедоступный IP-адрес</li>
						<li>Поддерживает ускорение сети с технологией виртуализации операций ввода-вывода с единым корнем (SR-IOV) для ВМ с ОС
							Windows Server</li>
						<li>Может получать трафик, не предназначенный для присвоенных ему частных IP-адресов, если для этого сетевого интерфейса
							включена IP-пересылка</li>
					</ul>
				</section>
			</section>
			<section>
				<h2 class="header-hide">Спасибо за внимание</h2>
				<img src="img/thanks.jpg" alt="" height="600">
			</section>
			<section>
				<section>
					<h2>Пример</h2>
				</section>
				<section>
					<h3></h3>
					<img src="img/vn_1.png" alt="">
				</section>
				<section>
					<h3></h3>
					<img src="img/vn_2.png" alt="">
				</section>
				<section>
					<h3></h3>
					<img src="img/vn_3.png" alt="">
				</section>
			</section>
		</div>
	</div>
	<aside id="presentable-icon" class="revealjs">
		<a title="Содержание лекции" href="#/0/1">
			<i class="fa fa-list-ul fa-2x"></i>
		</a>
	</aside>
	<script src="../../js/bundle.min.js"></script>
</body>

</html>