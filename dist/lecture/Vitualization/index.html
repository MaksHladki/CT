<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">
	<title>Название лекции</title>
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="Maks Hladki">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="../../css/bundle.min.css">
	<!--[if lt IE 9]>
		<script src="../../js/html5shiv.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<section>
					<h1>Название лекции</h1>
					<h3>Разработка динамичесих веб приложений</h3>
					<p>
						<small>Гладкий Максим Валерьевич / <a href="https://github.com/MaksHladki">github:MaksHladki</a></small>
					</p>
				</section>
				<section>
					<h2>Содержание лекции</h2>
					<nav id="presentable-toc" class="table-content"></nav>
				</section>
			</section>
			<section>
				<h2>Распространенные платформы виртуализации</h2>
				<ul>
					<li>VMWARE (ESX, Server)</li>
					<li>CITRIX (Xen)</li>
					<li>Sun xVM (Virtual box)</li>
					<li>Microsoft (Hyper-V)</li>
					<li>Parallels (Parallels)</li>
					<li>Virtualiron (Virtualiron)</li>
				</ul>
			</section>
			<section>
				<section>
					<h1>Гипервизор</h1>
					<blockquote>
						Гипервизор – это платформа виртуализации, позволяющая запускать на одном физическом компьютере несколько операционных систем.
						Именно гипервизор предоставляет изолированное окружение для каждой виртуальной машины, и именно он предоставляет гостевым
						ОС доступ к аппаратному обеспечению компьютера
					</blockquote>
					<p>https://habrahabr.ru/post/98580/</p>
				</section>
			</section>
			<section>
				<h1>Hyper-V</h1>
			</section>
			<section>
				<h2>История</h2>
				<ol>
					<li>2003 - Microsoft acquires Connectix</li>
					<li>2004 - Miscrosoft Visrtual Server 2005</li>
					<li>2005 - Microsoft Virtual Server 2005 R2</li>
					<li>2008 - Microsoft Hyper-V Server 2008</li>
					<li>2009 - Microsoft Hyper-V server 2008 R2</li>
					<li>2011 - Microsoft Hyper-V server 2008 R2 SP1</li>
					<li>2012 - Microsoft Hyper-V server 2012</li>
					<li>2013 - Microsoft Hyper-V server 2012 R2</li>
					<li>2016 - Microsoft Hyper-V server 2016</li>
				</ol>
			</section>
			<section>
				<h2>Типы виртуальных машин</h2>
				<ul>
					<li>BIOS based architecture - Generation 1</li>
					<li>EFI based architecture - Generation 2</li>
				</ul>
			</section>
			<section>
				<h2>Два способа развертывания</h2>
				<ul>
					<li>Как отдельная роль внутри ОС Windows</li>
					<li>Как самостоятельная ОС Windows Hyper-V Server</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Архитектура Hyper-V</h2>
				</section>
				<section>
					<h3>Общий вид</h3>
					<img src="img/Viridian_Architecture.svg" alt="" height="550">
				</section>
				<section>
					<h3>Понятие раздела</h3>
					<blockquote>
						Hyper-V поддерживает разграничение согласно понятию раздел. Раздел — логическая единица разграничения, поддерживаемая гипервизором,
						в котором работают операционные системы
					</blockquote>
					<ul>
						<li>Hyper-V поддерживает разграничение согласно понятию раздел</li>
						<li>Каждый экземпляр гипервизора должен иметь один родительский раздел</li>
					</ul>
				</section>
				<section>
					<h3>Алгоритм работы виртуализации</h3>
					<ol>
						<li>стек виртуализации запускается на родительском разделе и обладает прямым доступом к аппаратным устройствам</li>
						<li>родительский раздел порождает дочерние разделы, на которых и располагаются гостевые ОС, при помощи API гипервизова</li>
						<li>дочерний раздел также может породить собственные дочерние разделы</li>
					</ol>
				</section>
				<section>
					<h3>Родительский раздел</h3>
					<img src="img/HV_родительский_раздел.png" alt="">
					<ul>
						<li>Родительский раздел создается системой в первую очередь, как только гипервизор начинает работу</li>
						<li>Родительский раздел используется для создания и управления дочерними разделами системы и включает WMI провайдера, предоставляющего
							интерфейс для удаленного администрирования.</li>
						<li>Родительский раздел управляет и распределяет аппаратные ресурсы, за исключением процесса физического распределения
							памяти, который осуществляется гипервизором</li>
						<li>Аппаратные ресурсы родительского раздела являются общими и выделяются для использования дочерними разделами</li>
						<li>Родительский раздел управляет питанием, "plug and play" - операциями и ведет журналы аппаратных сбоев.</li>
						<li></li>
					</ul>
				</section>
				<section>
					<h3>Стек виртуализации</h3>
					<blockquote>
						Ряд компонент, располагающийся в родительском разделе, называется стеком виртуализации. Стек виртуализации имеет прямой доступ
						к аппаратному обеспечению хостового компьютера. Стек виртуализации состоит из следующих компонент:
					</blockquote>
					<ul>
						<li>Служба управления виртуальными машинами (VMMS)</li>
						<li>Рабочие процессы виртуальных машин (VMWP)</li>
						<li>Виртуальные устройства</li>
						<li>Драйвер виртуальной инфраструктуры (VID)</li>
						<li>Библиотека интерфейсов гипервизора</li>
					</ul>
				</section>
				<section>
					<h3>Дочерний раздел (child partition)</h3>
					<blockquote>
						Как уже отмечалось, в рамках дочерних разделов функционируют гостевые операционные системы. Гипервизор первого типа поддерживает
						три основные типа дочерних разделов:
					</blockquote>
					<ul>
						<li>с операционной системой семейства Windows и установленными компонентами интеграции;</li>
						<li>с операционной системой, отличной от семейства Windows и с установленными компонентами интеграции;</li>
						<li>с операционной системой, не поддерживающей компоненты интеграции.</li>
					</ul>
				</section>
				<section>
					<h2>Состояния ВМ для службы VMMS</h2>
					<ul>
						<li>Starting</li>
						<li>Active</li>
						<li>Not Active</li>
						<li>Taking Snapshot</li>
						<li>Applying Snapshot</li>
						<li>Deleting Snapshot</li>
						<li>Merging Disk</li>
					</ul>
				</section>
				<section>
					<h2>Рабочий процесс виртуальной машины (VMWP)</h2>
					<blockquote>
						Для управления виртуальной машиной из родительской партиции запускается особый процесс – рабочий процесс виртуальной машины
						(VMWP). Процесс этот работает на уровне пользователя. Для каждой запущенной виртуальной машины служба VMMS запускает
						отдельный рабочий процесс. Это позволяет изолировать виртуальные машины друг от друга. Для повышения безопасности,
						рабочие процессы запускаются под встроенным пользовательским аккаунтом Network Service.
					</blockquote>
					<ul>
						<li>Создание, конфигурация и запуск виртуальной машины</li>
						<li>Пауза и продолжение работы (Pause/Resume)</li>
						<li>Сохранение и восстановление состояния (Save/Restore State)</li>
						<li>Создание моментальных снимков (снапшотов)</li>
						<li>Кроме того, именно рабочий процесс эмулирует виртуальную материнскую плату (VMB), которая используется для предоставления
							памяти гостевой ОС, управления прерываниями и виртуальными устройствами.</li>
					</ul>
				</section>
				<section>
					<h2>Виртуальные устройства</h2>
					<blockquote>
						Виртуальные устройства (VDevs) – это программные модули, реализующие конфигурацию и управление устройствами для виртуальных
						машин. VMB включает в себя базовый набор виртуальных устройств, включающий в себя шину PCI и системные устройства,
						идентичные чипсету Intel 440BX. Есть два типа виртуальных устройств:
					</blockquote>
					<ul>
						<li>Эмулируемые устройства – эмулируют определенные аппаратные устройства, такие, к примеру, как видеоадаптер VESA. Эмулируемых
							устройств достаточно много, к примеру: BIOS, DMA, APIC, шины ISA и PCI, контроллеры прерываний, таймеры, управление
							питанием, контроллеры последовательных портов, системный динамик, контроллер PS/2 клавиатуры и мыши, эмулируемый (Legacy)
							Ethernet-адаптер (DEC/Intel 21140), FDD, IDE-контроллер и видеоадаптер VESA/VGA. Именно поэтому для загрузки гостевой
							ОС может использоваться только виртуальный IDE-контроллер, а не SCSI, который является синтетическим устройством.</li>
						<li>
							Синтетические устройства – не эмулируют реально существующие в природе железки. Примерами служат синтетический видеоадаптер,
							устройства взаимодействия с человеком (HID), сетевой адаптер, SCSI-контроллер, синтетический контроллер прерывания
							и контроллер памяти. Синтетические устройства могут использоваться только при условии установки компонент интеграции
							в гостевой ОС. Синтетические устройства обращаются к аппаратным устройствам сервера посредством провайдеров служб
							виртуализации, работающих в родительской партиции. Обращение идет через виртуальную шину VMBus, что намного быстрее,
							чем эмуляция физических устройств.
						</li>
					</ul>
				</section>
				<section>
					<h2>Драйвер виртуальной инфраструктуры (VID)</h2>
					<blockquote>
						Драйвер виртуальной инфраструктуры (vid.sys) работает на уровне ядра и осуществляет управление партициями, виртуальными процессорами
						и памятью. Так же этот драйвер является промежуточным звеном между гипервизором и компонентами стека виртуализации
						уровня пользователя.
					</blockquote>
				</section>
				<section>
					<h2>Библиотека интерфейса гипервизора</h2>
					<blockquote>
						Библиотека интерфейса гипервизора (WinHv.sys) – это DLL уровня ядра, которая загружается как в хостовой, так и в гостевых
						ОС, при условии установки компонент интеграции. Эта библиотека предоставляет интерфейс гипервызовов, использующийся
						для взаимодействия ОС и гипервизора.
					</blockquote>
				</section>
				<section>
					<h2>
						Провайдеры служб виртуализации (VSP)
					</h2>
					<blockquote>
						Провайдеры служб виртуализации работают в родительской партиции и предоставляют гостевым ОС доступ к аппаратным устройствам
						через клиент служб виртуализации (VSC). Связь между VSP и VSC осуществляется через виртуальную шину VMBus.
					</blockquote>
				</section>
				<section>
					<h2>Шина виртуальных машин (VMBus)</h2>
					<blockquote>
						Назначение VMBus состоит в предоставлении высокоскоростного доступа между родительской и дочерними партициями, в то время
						как остальные способы доступа значительно медленнее из-за высоких накладных расходах при эмуляции устройств. Если гостевая
						ОС не поддерживает работу интеграционных компонент – приходится использовать эмуляцию устройств. Это означает, что
						гипервизору приходится перехватывать вызовы гостевых ОС и перенаправлять их к эмулируемым устройствам, которые, напоминаю,
						эмулируются рабочим процессом виртуальной машины. Поскольку рабочий процесс запускается в пространстве пользователя,
						использование эмулируемых устройств приводит к значительному снижению производительности по сравнению с использованием
						VMBus. Именно поэтому рекомендуется устанавливать компоненты интеграции сразу же после установки гостевой ОС. Как уже
						было сказано, при использовании VMBus взаимодействие между хостовой и гостевой ОС происходит по клиент-серверной модели.
						В родительской партиции запущены провайдеры служб виртуализации (VSP), которые являются серверной частью, а в дочерних
						партициях – клиентская часть – VSC. VSC перенаправляет запросы гостевой ОС через VMBus к VSP в родительской партиции,
						а сам VSP переадресовывает запрос драйверу устройства. Этот процесс взаимодействия абсолютно прозрачен для гостевой
						ОС.
					</blockquote>
				</section>
				<section>
					<h3>Архитектурные особенности</h3>
					<ul>
						<li>Виртуализированные разделы не имеют ни доступа к физическому процессору, не могут управлять прерываниями</li>
						<li>Вместо этого у них есть виртуальное представление процессора и гостевой виртуальный адрес, зависящий от конфигурации
							гипервизора
						</li>
						<li>Дочерние разделы не имеют непосредственного доступа к аппаратным ресурсам, но зато получают виртуальное представление
							ресурсов, называемое виртуальными устройствами. </li>
						<li>Любая попытка обращения к виртуальным устройствам перенаправляется через VMBus к устройствам родительского раздела,
							которые и обработают данный запрос. VMBus — это логический канал, осуществляющий взаимодействие между разделами. Ответ
							возвращается также через VMBus.</li>
						<li>Родительские разделы запускают провайдер сервиса виртуализации (Virtualization Service Provider или сокр. VSP), который
							соединяется с VMBus и обрабатывает запросы доступа к устройствам от дочерних разделов. Виртуальные устройства дочернего
							раздела работают с клиентом сервиса виртуализации (Virtualization Service Client или сокр. VSC), который перенаправляет
							запрос через VMBus к VSP родительского раздела. Этот процесс прозрачен для гостевой ОС.</li>
						<li>Гипервизор может определять подмножество процессоров для каждого раздела</li>
						<li>ипервизор управляет прерываниями процессора и перенаправляет их в соответствующий раздел, используя логический контроллер
							искусственных прерываний</li>
						<li>Hyper-V может аппаратно ускорять трансляцию адресов между различными гостевыми виртуальными адресными пространствами
							при помощи IOMMU (I/O Memory Management Unit — Устройство управления вводом-выводом памяти), которое работает независимо
							от аппаратного управления памятью, используемого процессором</li>
						<li>Виртуальные устройства также поддерживают технологию Windows Server Virtualization, называемую прогрессивный ввод-вывод
							(англ. Enlightened I/O), для накопителей, сетевых и графических подсистем в том числе. </li>
					</ul>
				</section>
			</section>
			<section>
				<h2></h2>
			</section>
			<section>
				<h2>Характеристики</h2>
				<ul>
					<lI>Масштабируемость, производительность и плотность</lI>
					<lI></lI>
					<lI></lI>
					<lI></lI>
					<lI></lI>
				</ul>
			</section>
			<section>
				<h2>Ключевые особенности хранилища</h2>
				<ul>
					<li>Поддержка Virtual Fiber Channel (доступ к Fiber Channel SAN из ВМ)</li>
					<li>Нативная поддержка 4-КВ (преимущество от более емких и надежных дисков)</li>
					<li>Размер Virtual Hard Disk до 64 ТВ</li>
					<li>Offloaded Data Transfer (ODX) - повышает быстродействие используя SAN</li>
				</ul>
			</section>
			<section>
				<h2>Улучшенное управление ресурсами</h2>
				<ul>
					<li>Улучшение Dynamic Memory (более высокий уровень консолидации ВМ)</li>
					<li>Resource Metering (лог истории использования ВМ)</li>
					<li>QUality of Service (QoS) (позволяет обеспечить SLA по производительности ВМ)</li>
					<li>Data Center Bridging (DCB) - объеденяет сетевой трафик для повышения QoS</li>
					<li></li>
				</ul>
			</section>
			<section>
				<h2>Повышение уровня безопасности и изоляции</h2>
				<ul>
					<li>Private Virtual LAN</li>
					<li>Защита от ARP Spoofing</li>
					<li>DHCP Guard Protection</li>
					<li>Virtual Port ACLs</li>
					<li>Trunk Mode to Virtual Machine</li>
					<li>Monitoring and Port Mirroroing</li>
					<li>Windows PowerShell / WMI Managment</li>
					<li>IPSec</li>
					<li>SR-IOV</li>
					<li>Dynamic Virtual Machine Queue</li>
					<li>Extensible Switch - открытая платформа для созданий расширений с использованием Windows API</li>
				</ul>
			</section>
			<section>
				<h2>Физическая безопасность</h2>
				<p>Bitloker encryption</p>
				<ul>
					<li>Шифрование локальных жестких дисков</li>
					<li>Шифрование кластерных дисков</li>
					<li>Шифрование Cluster Shared Volumes</li>
					<li>Изменение Volume level encryption</li>
				</ul>
			</section>
			<section>
				<h2>Уровни миграции ВМ</h2>
				<ul>
					<li>Live Migration - бысрая миграция ВМ без ограничений</li>
					<li>Live Storage Migration - миграция дисков</li>
					<li>Shared-Nothing Live Migration - перенос ВМ между узлами и кластерами</li>
				</ul>
			</section>
			<section>
				<section>
					<h2>Пример создания ВМ</h2>
				</section>
				<section>
					<h3>Установка Hyper-V</h3>
					<img src="img/HV_1.png" alt="" height="550">
				</section>
				<section>
					<h3>Hyper-V Manager</h3>
					<img src="img/HV_2.png" alt="" height="550">
				</section>
				<section>
					<h3>Hyper-V Manager</h3>
					<img src="img/HV_3.png" alt="" height="550">
				</section>
				<section>
					<h3>Создание новой ВМ</h3>
					<img src="img/HV_4.png" alt="" height="550">
				</section>
				<section>
					<h3>Название и путь</h3>
					<img src="img/HV_5.png" alt="" height="550">
				</section>
				<section>
					<h3>Выбор типа</h3>
					<img src="img/HV_6.png" alt="" height="550">
				</section>
				<section>
					<h3>Размер ОП</h3>
					<img src="img/HV_7.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройка сети</h3>
					<img src="img/HV_8.png" alt="" height="550">
				</section>
				<section>
					<h3>Virtual Hard Disk</h3>
					<img src="img/HV_9.png" alt="" height="550">
				</section>
				<section>
					<h3>Дополнительные опции</h3>
					<img src="img/HV_10.png" alt="" height="550">
				</section>
				<section>
					<h3>Создание сетевого подключения</h3>
					<img src="img/HV_11.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройка параметров подключения</h3>
					<img src="img/HV_12.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: hardware</h3>
					<img src="img/HV_13.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: firmware</h3>
					<img src="img/HV_14.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: security</h3>
					<img src="img/HV_15.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: memory</h3>
					<img src="img/HV_16.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: processor</h3>
					<img src="img/HV_17.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: SCSI</h3>
					<img src="img/HV_18.png" alt="" height="550">
				</section>
				<section>
					<h3>Настройки ВМ: network</h3>
					<img src="img/HV_19.png" alt="" height="550">
				</section>
				<section>
					<h3>Запуск ВМ</h3>
					<img src="img/HV_20.png" alt="" height="550">
				</section>
				<section>
					<h3>Установка ОС</h3>
					<img src="img/HV_21.png" alt="" height="550">
				</section>
				<section>
					<h3>Результат установки</h3>
					<img src="img/HV_22.png" alt="" height="550">
				</section>
			</section>
			<!-- Содержимое лекции -->
			<section>
				<h2 class="header-hide">Спасибо за внимание</h2>
				<img src="img/thanks.jpg" alt="" height="600">
			</section>
		</div>
	</div>
	<aside id="presentable-icon" class="revealjs">
		<a title="Содержание лекции" href="#/0/1">
			<i class="fa fa-list-ul fa-2x"></i>
		</a>
	</aside>
	<script src="../../js/bundle.min.js"></script>
</body>

</html>